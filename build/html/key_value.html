<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>23. BREXX KEY/VALUE Database &mdash; BREXX370 V2R5M3 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=dc75d81f"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="24. Formatted screens" href="fss.html" />
    <link rel="prev" title="22. VSAM User’s Guide" href="vsam.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            BREXX370
          </a>
              <div class="version">
                V2R5M3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">1. Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#useful-functions">2. Useful functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tokens_and_terms.html">3. Tokens and Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressions.html">4. Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="instructions.html">5. Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="templates.html">6. Templates for ARG, PULL, and PARSE</a></li>
<li class="toctree-l1"><a class="reference internal" href="compound.html">7. Compound Variable Names</a></li>
<li class="toctree-l1"><a class="reference internal" href="special.html">8. Special Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">9. Interactive Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="builtin.html">10. Built-in Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="calling.html">11. Calling external REXX Scripts or Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="mvs.html">12. BREXX MVS Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="added.html">13. Added BREXX Kernel functions and Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="global.html">14. GLOBAL Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">15. Dataset Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tcpip.html">16. TCP Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tso.html">17. TSO REXX Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="array.html">18. Array functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="rxlib.html">19. RXLIB functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tso_commands.html">20. Building TSO Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_function.html">21. Callable External Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="vsam.html">22. VSAM User’s Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">23. BREXX KEY/VALUE Database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">23.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overview-of-the-vsam-key-structure">23.2. Overview of the VSAM Key structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-key-value-database-functions">23.3. Installing the Key/Value Database Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-value-modules">23.4. Key/Value Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#customisation-optional">23.5. Customisation (optional)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-the-sample-key-value-database">23.6. Loading the sample Key/Value Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-value-database-functions">23.7. Key/Value Database Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vsam-functions">23.8. VSAM Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#DBOPEN"><code class="docutils literal notranslate"><span class="pre">DBOPEN()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBROOM"><code class="docutils literal notranslate"><span class="pre">DBROOM()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBCLOSE"><code class="docutils literal notranslate"><span class="pre">DBCLOSE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBSET"><code class="docutils literal notranslate"><span class="pre">DBSET()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBGET"><code class="docutils literal notranslate"><span class="pre">DBGET()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBDEL"><code class="docutils literal notranslate"><span class="pre">DBDEL()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBREMOVE"><code class="docutils literal notranslate"><span class="pre">DBREMOVE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBLOCATE"><code class="docutils literal notranslate"><span class="pre">DBLOCATE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBNEXT"><code class="docutils literal notranslate"><span class="pre">DBNEXT()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBLINK"><code class="docutils literal notranslate"><span class="pre">DBLINK()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBDELREF"><code class="docutils literal notranslate"><span class="pre">DBDELREF()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBDELREFALL"><code class="docutils literal notranslate"><span class="pre">DBDELREFALL()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBPRINT"><code class="docutils literal notranslate"><span class="pre">DBPRINT()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBOUTARRAY"><code class="docutils literal notranslate"><span class="pre">DBOUTARRAY()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBSAY"><code class="docutils literal notranslate"><span class="pre">DBSAY()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBRCOUNT"><code class="docutils literal notranslate"><span class="pre">DBRCOUNT()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#report-and-maintenance-functions">23.9. Report and Maintenance Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#DBLIST"><code class="docutils literal notranslate"><span class="pre">DBLIST()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBKEEP"><code class="docutils literal notranslate"><span class="pre">DBKEEP()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBNKEEP"><code class="docutils literal notranslate"><span class="pre">DBNKEEP()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBHOOD"><code class="docutils literal notranslate"><span class="pre">DBHOOD()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBREFERENCE"><code class="docutils literal notranslate"><span class="pre">DBREFERENCE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBUSAGE"><code class="docutils literal notranslate"><span class="pre">DBUSAGE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#DBROOMS"><code class="docutils literal notranslate"><span class="pre">DBROOMS()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#key-value-database-tailoring">23.10. Key/Value Database Tailoring</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defining-an-information-model-optional">23.10.1. Defining an Information Model (optional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-additional-key-value-databases">23.10.2. Defining additional Key/Value Databases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-a-key-value-profile">23.10.3. Setting up a Key/Value Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cluster-definition">23.10.4. Cluster Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage-of-the-new-cluster-definition">23.10.5. Usage of the new Cluster Definition</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fss.html">24. Formatted screens</a></li>
<li class="toctree-l1"><a class="reference internal" href="application.html">25. Application Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="restrictions.html">26. Implementation Restrictions</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">27. Migration and Upgrade Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html">28. About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BREXX370</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">23. </span>BREXX KEY/VALUE Database</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/key_value.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="brexx-key-value-database">
<h1><span class="section-number">23. </span>BREXX KEY/VALUE Database<a class="headerlink" href="#brexx-key-value-database" title="Link to this heading"></a></h1>
<section id="introduction">
<h2><span class="section-number">23.1. </span>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>Accessing the underlying VSAM KSDS is made simple by using the Key/Value
Database. You do not require extensive VSAM understanding nor do you need
to be familiar with the database’s intricate structure. The Key/Value Database
is standardised.</p>
<p>The system consists of two VSAM files: a source and a reference database. The
reference DB facilitates source record linking of the K/V database. This makes
it possible to implement simple databases like hierarchical or graph databases.</p>
</section>
<section id="overview-of-the-vsam-key-structure">
<h2><span class="section-number">23.2. </span>Overview of the VSAM Key structure<a class="headerlink" href="#overview-of-the-vsam-key-structure" title="Link to this heading"></a></h2>
<p>The K/V functions handle everything; memorizing the VSAM structure is not
required, but it should not be overlooked for completeness.</p>
<p>The VSAM structure in an overview, the partition, which will be called the
room, is 2 bytes long, the qualifier is 10 bytes long, and the key itself
is 32 bytes long, making the total key length 44 bytes. Therefore, having the
same key but different qualifiers is possible. Being in multiple rooms allows
you to make use of the same key and qualification.</p>
<p>Any changes you make to these default settings will necessitate modifications
in the BREXX module DBPROF, which is stored in your RXLIB.
To address records, use the key element, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Call</span> <span class="n">DBSET</span><span class="p">([</span><span class="n">qualifier</span><span class="o">.</span><span class="p">]</span><span class="n">key</span><span class="p">,</span> <span class="n">record</span><span class="p">)</span>
<span class="n">Call</span> <span class="n">DBGET</span><span class="p">([</span><span class="n">qualifier</span><span class="o">.</span><span class="p">]</span><span class="n">key</span><span class="p">)</span>
<span class="n">Say</span> <span class="n">Result</span>
</pre></div>
</div>
<p>The qualifier is always converted to <strong>lowercase</strong>. The key is case-sensitive
unless you set in your database profile (usually DBPROF) <strong>ddprof.keyupper to 1</strong>.</p>
<p>The qualifier is optional and, if not specified, will be set to <strong>any</strong>. If the
qualifier and key are shorter than their definitions, they will be suffixed
with “_” to achieve the maximum length feasible.</p>
</section>
<section id="installing-the-key-value-database-functions">
<h2><span class="section-number">23.3. </span>Installing the Key/Value Database Functions<a class="headerlink" href="#installing-the-key-value-database-functions" title="Link to this heading"></a></h2>
<p>The Key/Value program is included with BREXX and does not require any
additional installation. However, you must configure and submit the VSAM
Clusters in the member $CREKEYV in the BREXX installation dataset. For more
details, see Step 6 in the BREXX installation dataset manual.</p>
</section>
<section id="key-value-modules">
<h2><span class="section-number">23.4. </span>Key/Value Modules<a class="headerlink" href="#key-value-modules" title="Link to this heading"></a></h2>
<p>Library content:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DBOPEN   Key/Value REXX contains all procedures
DBPROF   Key/Value profile with essential information
SAMPLE1  Key/Value sample to test it
$CREKEYV as part of the BREXX installation library
</pre></div>
</div>
</section>
<section id="customisation-optional">
<h2><span class="section-number">23.5. </span>Customisation (optional)<a class="headerlink" href="#customisation-optional" title="Link to this heading"></a></h2>
<p>Aside from the fundamental parameters (names and lengths), the PDS member
DBPROF allows you to modify the behaviour. Especially you can instruct the
DBLINK function to construct dummy source records if one of the records to be
connected does not exist. Another option is to have it translate the key into
uppercase. This is the default setting.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ddprof</span><span class="o">.</span><span class="n">EnableDummy</span><span class="o">=</span><span class="mi">1</span>             <span class="o">/*</span> <span class="n">allow</span> <span class="n">links</span> <span class="n">between</span> <span class="n">records</span>   <span class="o">*/</span>
                                 <span class="o">/*</span> <span class="n">which</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">,</span> <span class="n">they</span> <span class="n">will</span> <span class="o">*/</span>
                                 <span class="o">/*</span> <span class="n">create</span> <span class="n">DUMMY</span> <span class="n">source</span> <span class="n">records</span>   <span class="o">*/</span>
                                 <span class="o">/*</span> <span class="mi">0</span><span class="p">:</span> <span class="n">no</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">yes</span>                 <span class="o">*/</span>

<span class="n">ddprof</span><span class="o">.</span><span class="n">keyupper</span><span class="o">=</span><span class="mi">0</span>                <span class="o">/*</span> <span class="n">upper</span> <span class="n">case</span> <span class="n">translation</span> <span class="n">of</span> <span class="n">the</span> <span class="o">*/</span>
                                 <span class="o">/*</span> <span class="n">key</span><span class="o">.</span> <span class="mi">0</span><span class="p">:</span> <span class="n">no</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">yes</span>            <span class="o">*/</span>
</pre></div>
</div>
</section>
<section id="loading-the-sample-key-value-database">
<h2><span class="section-number">23.6. </span>Loading the sample Key/Value Database<a class="headerlink" href="#loading-the-sample-key-value-database" title="Link to this heading"></a></h2>
<p>A sample is included in the BREXX installation and can be loaded using the
REXX: <cite>BREXX.V2R5M3.SAMPLE(DBWORLD)</cite>. It includes all countries in the
world, a few trade unions, and the country’s main cities. It is used in the
following examples to demonstrate how the K/V and reference databases work.</p>
<blockquote>
<div><p>KV160I    Check-in Standard Room  (AA)
KV120I    Key/Value DB successfully opened
10:25:20.626631 Start loading Countries
10:25:29.178898 Loading Countries completed, 203 loaded
10:25:29.180352 Link them to Trade Unions
10:25:31.231292 Link to Trade Unions completed
10:25:31.603774 Start loading Cities and Link them to their Country
10:25:51.079262 loading Cities completed, 774 loaded</p>
</div></blockquote>
</section>
<section id="key-value-database-functions">
<h2><span class="section-number">23.7. </span>Key/Value Database Functions<a class="headerlink" href="#key-value-database-functions" title="Link to this heading"></a></h2>
<p>To use the Key/Value database functions you need to import KEYVALUE (part of your RXLIB).</p>
<blockquote>
<div><p>CALL IMPORT KEYVALUE</p>
</div></blockquote>
<p>Let us start with a simple example, it should be self-explanatory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">call</span> <span class="kn">import</span> <span class="nn">keyvalue</span>
<span class="linenos"> 2</span><span class="n">say</span> <span class="s2">&quot;OPEN  &quot;</span><span class="n">DBOPEN</span><span class="p">()</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="o">/*</span> <span class="n">Add</span> <span class="n">Continents</span>  <span class="o">*/</span>
<span class="linenos"> 5</span>   <span class="n">Call</span> <span class="n">DBSET</span><span class="p">(</span><span class="s1">&#39;Continent.Europe&#39;</span><span class="p">,</span><span class="s1">&#39;Continent Europe&#39;</span><span class="p">)</span>
<span class="linenos"> 6</span>   <span class="n">Call</span> <span class="n">DBSET</span><span class="p">(</span><span class="s1">&#39;Continent.Asia&#39;</span><span class="p">,</span><span class="s1">&#39;Continent Asia&#39;</span><span class="p">)</span>
<span class="linenos"> 7</span>   <span class="n">Call</span> <span class="n">DBSET</span><span class="p">(</span><span class="s1">&#39;Continent.Africa&#39;</span><span class="p">,</span><span class="s1">&#39;Continent Africa&#39;</span><span class="p">)</span>
<span class="linenos"> 8</span>   <span class="n">Call</span> <span class="n">DBSET</span><span class="p">(</span><span class="s1">&#39;Continent.North America&#39;</span><span class="p">,</span><span class="s1">&#39;Continent North America&#39;</span><span class="p">)</span>
<span class="linenos"> 9</span>   <span class="n">Call</span> <span class="n">DBSET</span><span class="p">(</span><span class="s1">&#39;Continent.South America&#39;</span><span class="p">,</span><span class="s1">&#39;Continent South America&#39;</span><span class="p">)</span>
<span class="linenos">10</span>   <span class="n">Call</span> <span class="n">DBSET</span><span class="p">(</span><span class="s1">&#39;Continent.Australia&#39;</span><span class="p">,</span><span class="s1">&#39;Australia and Oceania&#39;</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="o">/*</span> <span class="n">Get</span> <span class="n">Continents</span>  <span class="o">*/</span>
<span class="linenos">13</span>   <span class="n">call</span> <span class="n">DBGET</span><span class="p">(</span><span class="s1">&#39;Continent.Europe&#39;</span><span class="p">)</span>
<span class="linenos">14</span>   <span class="n">say</span> <span class="n">dbresult</span>
<span class="linenos">15</span>   <span class="n">call</span> <span class="n">DBGET</span><span class="p">(</span><span class="s1">&#39;Continent.Asia&#39;</span><span class="p">)</span>
<span class="linenos">16</span>   <span class="n">say</span> <span class="n">dbresult</span>
<span class="linenos">17</span>   <span class="n">call</span> <span class="n">DBGET</span><span class="p">(</span><span class="s1">&#39;Continent.Africa&#39;</span><span class="p">)</span>
<span class="linenos">18</span>   <span class="n">say</span> <span class="n">dbresult</span>
<span class="linenos">19</span>   <span class="n">call</span> <span class="n">DBGET</span><span class="p">(</span><span class="s1">&#39;Continent.North America&#39;</span><span class="p">)</span>
<span class="linenos">20</span>   <span class="n">say</span> <span class="n">dbresult</span>
<span class="linenos">21</span>   <span class="n">call</span> <span class="n">DBGET</span><span class="p">(</span><span class="s1">&#39;Continent.South America&#39;</span><span class="p">)</span>
<span class="linenos">22</span>   <span class="n">say</span> <span class="n">dbresult</span>
<span class="linenos">23</span>   <span class="n">call</span> <span class="n">DBGET</span><span class="p">(</span><span class="s1">&#39;Continent.Australia&#39;</span><span class="p">)</span>
<span class="linenos">24</span>   <span class="n">say</span> <span class="n">dbresult</span>
<span class="linenos">25</span>   <span class="n">say</span> <span class="s2">&quot;CLOSE &quot;</span><span class="n">DBCLOSE</span><span class="p">()</span>
<span class="linenos">26</span><span class="n">exit</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KV160I</span>    <span class="n">Check</span><span class="o">-</span><span class="ow">in</span> <span class="n">Standard</span> <span class="n">Room</span>  <span class="p">(</span><span class="n">AA</span><span class="p">)</span>
<span class="n">KV120I</span>    <span class="n">Key</span><span class="o">/</span><span class="n">Value</span> <span class="n">DB</span> <span class="n">successfully</span> <span class="n">opened</span>
<span class="n">OPEN</span> <span class="mi">0</span>
<span class="n">Continent</span> <span class="n">Europe</span>
<span class="n">Continent</span> <span class="n">Asia</span>
<span class="n">Continent</span> <span class="n">Africa</span>
<span class="n">Continent</span> <span class="n">North</span> <span class="n">America</span>
<span class="n">Continent</span> <span class="n">South</span> <span class="n">America</span>
<span class="n">Australia</span> <span class="ow">and</span> <span class="n">Oceania</span>
<span class="n">CLOSE</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="vsam-functions">
<h2><span class="section-number">23.8. </span>VSAM Functions<a class="headerlink" href="#vsam-functions" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="DBOPEN">
<span class="sig-name descname"><span class="pre">DBOPEN</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBOPEN" title="Link to this definition"></a></dt>
<dd><p>Opens the key/value VSAM dataset.</p>
<p>Opens the standard Key/Value Database. If DBOPEN was successful an RC of
zero is returned, else it failed.</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">say</span><span class="w"> </span><span class="s">&quot;OPEN  &quot;</span>DBOPEN<span class="o">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">  </span>OPEN<span class="w">  </span><span class="m">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBROOM">
<span class="sig-name descname"><span class="pre">DBROOM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">room-name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBROOM" title="Link to this definition"></a></dt>
<dd><p>Assigns a room.</p>
<p>The DBROOM function divides the Key/Value Database into distinct areas
that can be projects, applications, or anything else. This means that you
have many Key/Value Databases in a single VSAM dataset.</p>
<p>The definition of a room is optional if not defined it automatically
switches into a standard room. Use the DBROOM command to define a new room
or to reuse an existing one. If the room is not already there, it will be
created and recorded in the Key/Value database’s control record. There
will always be an uppercase translation of the room name.</p>
<p>By designating a room, you can specify the space where the following
commands take effect.</p>
<p>You can define the same Key of a record more than once by using various
rooms. Since they cannot see one another, rooms cannot communicate.</p>
<p>For example, write records (with the same key) in different rooms and
report them.</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kr">call</span><span class="w"> </span>import<span class="w"> </span><span class="s">&#39;KeyValue&#39;</span>
<span class="linenos"> 2</span><span class="kr">call</span><span class="w"> </span>DBOPEN
<span class="linenos"> 3</span><span class="kr">call</span><span class="w"> </span>DBROOM<span class="w"> </span><span class="s">&#39;Beverages&#39;</span>
<span class="linenos"> 4</span><span class="kr">say</span><span class="w"> </span><span class="s">&#39;*** Room Beverages ***&#39;</span>
<span class="linenos"> 5</span><span class="kr">call</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Beer&#39;</span><span class="o">,</span><span class="s">&#39;Munich Hofbraeuhaus&#39;</span><span class="o">)</span>
<span class="linenos"> 6</span><span class="kr">call</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Whisky&#39;</span><span class="o">,</span><span class="s">&#39;Black Label&#39;</span><span class="o">)</span>
<span class="linenos"> 7</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Whisky&#39;</span><span class="o">)</span>
<span class="linenos"> 8</span><span class="w">   </span><span class="kr">say</span><span class="w"> </span><span class="nb">left</span><span class="o">(</span>dbkey<span class="o">,</span><span class="m">8</span><span class="o">)</span><span class="s">&#39;: &#39;</span><span class="w"> </span>dbresult
<span class="linenos"> 9</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Beer&#39;</span><span class="o">)</span>
<span class="linenos">10</span><span class="w">   </span><span class="kr">say</span><span class="w"> </span><span class="nb">left</span><span class="o">(</span>dbkey<span class="o">,</span><span class="m">8</span><span class="o">)</span><span class="s">&#39;: &#39;</span><span class="w"> </span>dbresult
<span class="linenos">11</span><span class="kr">call</span><span class="w"> </span>DBROOM<span class="w"> </span><span class="s">&#39;Booze&#39;</span>
<span class="linenos">12</span><span class="kr">say</span><span class="w"> </span><span class="s">&#39;*** Room Booze     ***&#39;</span>
<span class="linenos">13</span><span class="kr">call</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Beer&#39;</span><span class="o">,</span><span class="s">&#39;Guiness&#39;</span><span class="o">)</span>
<span class="linenos">14</span><span class="kr">call</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Whisky&#39;</span><span class="o">,</span><span class="s">&#39;Bushmills&#39;</span><span class="o">)</span>
<span class="linenos">15</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Whisky&#39;</span><span class="o">)</span>
<span class="linenos">16</span><span class="w">   </span><span class="kr">say</span><span class="w"> </span><span class="nb">left</span><span class="o">(</span>dbkey<span class="o">,</span><span class="m">8</span><span class="o">)</span><span class="s">&#39;: &#39;</span><span class="w"> </span>dbresult
<span class="linenos">17</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Beer&#39;</span><span class="o">)</span>
<span class="linenos">18</span><span class="w">   </span><span class="kr">say</span><span class="w"> </span><span class="nb">left</span><span class="o">(</span>dbkey<span class="o">,</span><span class="m">8</span><span class="o">)</span><span class="s">&#39;: &#39;</span><span class="w"> </span>dbresult
<span class="linenos">19</span><span class="kr">call</span><span class="w"> </span>DBROOM<span class="w"> </span><span class="s">&#39;Beverages&#39;</span>
<span class="linenos">20</span><span class="kr">say</span><span class="w"> </span><span class="s">&#39;*** Room Beverages ***&#39;</span>
<span class="linenos">21</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Whisky&#39;</span><span class="o">)</span>
<span class="linenos">22</span><span class="w">   </span><span class="kr">say</span><span class="w"> </span><span class="nb">left</span><span class="o">(</span>dbkey<span class="o">,</span><span class="m">8</span><span class="o">)</span><span class="s">&#39;: &#39;</span><span class="w"> </span>dbresult
<span class="linenos">23</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Beer&#39;</span><span class="o">)</span>
<span class="linenos">24</span><span class="w">   </span><span class="kr">say</span><span class="w"> </span><span class="nb">left</span><span class="o">(</span>dbkey<span class="o">,</span><span class="m">8</span><span class="o">)</span><span class="s">&#39;: &#39;</span><span class="w"> </span>dbresult
<span class="linenos">25</span><span class="kr">call</span><span class="w"> </span>dbclose
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KV160I</span>    <span class="n">Check</span><span class="o">-</span><span class="ow">in</span> <span class="n">Standard</span> <span class="n">Room</span>  <span class="p">(</span><span class="n">AA</span><span class="p">)</span>
<span class="n">KV120I</span>    <span class="n">Key</span><span class="o">/</span><span class="n">Value</span> <span class="n">DB</span> <span class="n">successfully</span> <span class="n">opened</span>
<span class="o">***</span> <span class="n">Room</span> <span class="n">Beverages</span> <span class="o">***</span>
<span class="n">Whisky</span>  <span class="p">:</span>  <span class="n">Black</span> <span class="n">Label</span>
<span class="n">Beer</span>    <span class="p">:</span>  <span class="n">Munich</span> <span class="n">Hofbraeuhaus</span>
<span class="o">***</span> <span class="n">Room</span> <span class="n">Booze</span>     <span class="o">***</span>
<span class="n">Whisky</span>  <span class="p">:</span>  <span class="n">Bushmills</span>
<span class="n">Beer</span>    <span class="p">:</span>  <span class="n">Guiness</span>
<span class="o">***</span> <span class="n">Room</span> <span class="n">Beverages</span> <span class="o">***</span>
<span class="n">Whisky</span>  <span class="p">:</span>  <span class="n">Black</span> <span class="n">Label</span>
<span class="n">Beer</span>    <span class="p">:</span>  <span class="n">Munich</span> <span class="n">Hofbraeuhaus</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBCLOSE">
<span class="sig-name descname"><span class="pre">DBCLOSE</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBCLOSE" title="Link to this definition"></a></dt>
<dd><p>Closes the Key/Value Database.</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">say</span><span class="w"> </span><span class="s">&quot;CLOSE &quot;</span>DBCLOSE<span class="o">()</span><span class="w">  </span><span class="o">-&gt;</span><span class="w">        </span>CLOSE<span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBSET">
<span class="sig-name descname"><span class="pre">DBSET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key,</span> <span class="pre">value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBSET" title="Link to this definition"></a></dt>
<dd><p>Writes a key/value record to the DB.</p>
<p>The record indicated by the qualifier and key arguments will be saved
into the Key/Value Database. If the record is already present, it will be
overwritten.</p>
<p>A BREXX DCL data structure can be used to compose the record’s various
components. Go to the BREXX User’s Guide for further information.
<cite>DCL(‘structure-name,’$DEFINE’)</cite>. The qualifier parameter defaults to “any”.</p>
<p>Return codes:
- 0 Put successfully
- 8 Put failed</p>
<p>Variables:
- <cite>dbKey</cite> contains the key
- <cite>dbFKey</cite> contains the full key (including the qualifier, key)
- <cite>dbResult</cite> contains the full record (including the full key)
- <cite>dbRC</cite> return code of the function</p>
<p>For example, adding continents to the database:</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cm">/* Add Continents  */</span>
<span class="linenos">2</span><span class="w">   </span><span class="kr">SAY</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Cont.Europe&#39;</span><span class="o">,</span><span class="s">&#39;Continent Europe&#39;</span><span class="o">)</span>
<span class="linenos">3</span><span class="w">   </span><span class="kr">SAY</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Cont.Asia&#39;</span><span class="o">,</span><span class="s">&#39;Continent Asia&#39;</span><span class="o">)</span>
<span class="linenos">4</span><span class="w">   </span><span class="kr">SAY</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Cont.Africa&#39;</span><span class="o">,</span><span class="s">&#39;Continent Africa&#39;</span><span class="o">)</span>
<span class="linenos">5</span><span class="w">   </span><span class="kr">SAY</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Cont.North America&#39;</span><span class="o">,</span><span class="s">&#39;Continent North America&#39;</span><span class="o">)</span>
<span class="linenos">6</span><span class="w">   </span><span class="kr">SAY</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Cont.South America&#39;</span><span class="o">,</span><span class="s">&#39;Continent South America&#39;</span><span class="o">)</span>
<span class="linenos">7</span><span class="w">   </span><span class="kr">SAY</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Cont.Australia&#39;</span><span class="o">,</span><span class="s">&#39;Australia and Oceania&#39;</span><span class="o">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBGET">
<span class="sig-name descname"><span class="pre">DBGET</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier].key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBGET" title="Link to this definition"></a></dt>
<dd><p>Reads a key/value record from the DB.</p>
<p>A BREXX DCL data structure can be used to compose the record’s various components. Go to the BREXX User’s Guide for further information. DCL(‘structure-name,’$DEFINE’). The qualifier parameter defaults to “any”.</p>
<p>Return code:
- 0 Get successfully
- 8 Get failed</p>
<p>Variables:
- <cite>dbKey</cite> contains the key
- <cite>dbFKey</cite> contains the full key (including the qualifier, key)
- <cite>dbResult</cite> contains the full record (including the full key)
- <cite>dbRC</cite> return code of the function</p>
<p>For example, reading the Continents</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cm">/* Get Continents  */</span>
<span class="linenos"> 2</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Cont.Europe&#39;</span><span class="o">)</span>
<span class="linenos"> 3</span><span class="kr">say</span><span class="w"> </span>dbresult
<span class="linenos"> 4</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Cont.Asia&#39;</span><span class="o">)</span>
<span class="linenos"> 5</span><span class="kr">say</span><span class="w"> </span>dbresult
<span class="linenos"> 6</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Cont.Africa&#39;</span><span class="o">)</span>
<span class="linenos"> 7</span><span class="kr">say</span><span class="w"> </span>dbresult
<span class="linenos"> 8</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Cont.North America&#39;</span><span class="o">)</span>
<span class="linenos"> 9</span><span class="kr">say</span><span class="w"> </span>dbresult
<span class="linenos">10</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Cont.South America&#39;</span><span class="o">)</span>
<span class="linenos">11</span><span class="kr">say</span><span class="w"> </span>dbresult
<span class="linenos">12</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Cont.Australia&#39;</span><span class="o">)</span>
<span class="linenos">13</span><span class="kr">say</span><span class="w"> </span>dbresult
</pre></div>
</div>
<p>Results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Continent</span> <span class="n">Europe</span>
<span class="n">Continent</span> <span class="n">Asia</span>
<span class="n">Continent</span> <span class="n">Africa</span>
<span class="n">Continent</span> <span class="n">North</span> <span class="n">America</span>
<span class="n">Continent</span> <span class="n">South</span> <span class="n">America</span>
<span class="n">Australia</span> <span class="ow">and</span> <span class="n">Oceania</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBDEL">
<span class="sig-name descname"><span class="pre">DBDEL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBDEL" title="Link to this definition"></a></dt>
<dd><p>Deletes a record specified by the qualifier and key parameters. The
qualifier parameter defaults to “any”.</p>
<p>Return code:
- 0 Get successfully
- 8 Get failed</p>
<p>Variables:
- <cite>dbKey</cite> contains the key
- <cite>dbFKey</cite> contains the full key (including the qualifier, key)
- <cite>dbResult</cite> contains the full record (including the full key)
- <cite>dbRC</cite> return code of the function</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cm">/* Remove Europe and Asia, add Eurasia instead */</span>
<span class="linenos">2</span><span class="kr">say</span><span class="w"> </span><span class="s">&quot;Delete &quot;</span>DBDEL<span class="o">(</span><span class="s">&#39;Cont.Europe&#39;</span><span class="o">)</span>
<span class="linenos">3</span><span class="kr">say</span><span class="w"> </span>dbresult
<span class="linenos">4</span><span class="kr">say</span><span class="w"> </span><span class="s">&quot;Delete &quot;</span>DBDEL<span class="o">(</span><span class="s">&#39;Cont.Asia&#39;</span><span class="o">)</span>
<span class="linenos">5</span><span class="kr">say</span><span class="w"> </span>dbresult
<span class="linenos">6</span><span class="kr">call</span><span class="w"> </span>DBSET<span class="o">(</span><span class="s">&#39;Cont.Eurasia&#39;</span><span class="o">,</span><span class="s">&#39;Continent of Eurasia&#39;</span><span class="o">)</span>
<span class="linenos">7</span><span class="kr">say</span><span class="w"> </span>dbresult
<span class="linenos">8</span><span class="kr">call</span><span class="w"> </span>DBGET<span class="o">(</span><span class="s">&#39;Cont.Eurasia&#39;</span><span class="o">,</span><span class="s">&#39;Continent of Eurasia&#39;</span><span class="o">)</span>
<span class="linenos">9</span><span class="kr">say</span><span class="w"> </span>dbresult
</pre></div>
</div>
<p>Results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Delete</span> <span class="mi">0</span>
<span class="n">CONT____Europe__________________________Continent</span> <span class="n">Europe</span>
<span class="n">Delete</span> <span class="mi">0</span>
<span class="n">CONT____Asia____________________________Continent</span> <span class="n">Asia</span>
<span class="n">CONT____Eurasia_________________________Continent</span> <span class="n">of</span> <span class="n">Eurasia</span>
<span class="n">Continent</span> <span class="n">of</span> <span class="n">Eurasia</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBREMOVE">
<span class="sig-name descname"><span class="pre">DBREMOVE</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">QUALIFIER/ALL/ONLY/ANY/CONTAINS</span></span></em>, <span class="optional">]</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBREMOVE" title="Link to this definition"></a></dt>
<dd><p>Removes records of a project.</p>
<p>REMOVE records of the actual room.</p>
<p>Keywords:
- <cite>ALL</cite> removes all members of the active room
- <cite>QUALIFIER</cite> removes all records of the qualifier defined in the string parameter
- <cite>ONLY</cite> removes all records whose key starts with the given string. The key is the plain key without the qualifier
- <cite>ANY</cite> removes all records whose key contains the string parameter. The key is the plain key without the qualifier
- <cite>CONTAINS</cite> removes all records whose record content contains string parameter</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is no function to remove all records of the VSAM dataset.</p>
</div>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">call</span><span class="w"> </span>import<span class="w"> </span>KeyValue
<span class="linenos">2</span><span class="kr">call</span><span class="w"> </span>dbmsglv<span class="w"> </span><span class="s">&#39;N&#39;</span>
<span class="linenos">3</span><span class="kr">say</span><span class="w"> </span><span class="s">&quot;OPEN  &quot;</span>DBOPEN<span class="o">()</span><span class="w">             </span><span class="cm">/* Open Key/Value Database */</span>
<span class="linenos">4</span><span class="kr">say</span><span class="w"> </span><span class="s">&quot;ROOM  &quot;</span>DBROOM<span class="o">(</span><span class="s">&#39;WORLD&#39;</span><span class="o">)</span><span class="w">      </span><span class="cm">/* switch to WORLD         */</span>
<span class="linenos">5</span><span class="kr">call</span><span class="w"> </span>dbremove<span class="o">(</span><span class="s">&#39;QUA&#39;</span><span class="o">,</span><span class="s">&quot;Continent&quot;</span><span class="o">)</span><span class="w"> </span><span class="cm">/* Remove records w. qualifier Continent */</span>
<span class="linenos">6</span><span class="kr">call</span><span class="w"> </span>dbremove<span class="o">(</span><span class="s">&#39;ANY&#39;</span><span class="o">,</span><span class="s">&quot;Mu&quot;</span><span class="o">)</span><span class="w">        </span><span class="cm">/* Remove recs containing Mu in the key */</span>
<span class="linenos">7</span><span class="kr">call</span><span class="w"> </span>dbremove<span class="o">(</span><span class="s">&#39;ONLY&#39;</span><span class="o">,</span><span class="s">&quot;Wa&quot;</span><span class="o">)</span><span class="w">       </span><span class="cm">/* Remove recs with starting key Wa */</span>
<span class="linenos">8</span><span class="kr">call</span><span class="w"> </span>dbremove<span class="o">(</span><span class="s">&#39;ALL&#39;</span><span class="o">)</span><span class="w">             </span><span class="cm">/* Remove all recs of the active room */</span>
<span class="linenos">9</span><span class="kr">say</span><span class="w"> </span><span class="s">&quot;CLOSE &quot;</span>DBCLOSE<span class="o">()</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>OPEN  4
ROOM  0
Remove all records of room WORLD(AB) with Qualifier continent
------------------------------------------------------------------------
continent.Africa removed
continent.Asia removed
continent.Australia removed
continent.Europe removed
continent.North_America removed
continent.South_America removed
Number of records removed 6

Remove records of room WORLD(AB) containing Mu in key
------------------------------------------------------------------------
city.Multan removed
city.Mumbai removed
city.Munich removed
city.Murcia removed
city.Muscat removed
Number of records removed 5

Remove records of room WORLD(AB) with starting key Wa
------------------------------------------------------------------------
city.Warsaw removed
city.Washington removed
city.Washington_DC removed
Number of records removed 3

Remove all records of room WORLD(AB)
------------------------------------------------------------------------
city.`Ajman removed
city.Aarhus removed
city.Aba removed
city.Abidjan removed
city.Abomey-Calavi removed
city.Abu_Dhabi removed
city.Abuja removed
city.Accra removed
city.Ad_Dammam removed
city.Adana removed
city.Addis_Ababa removed
...
country.Zambia removed
country.Zimbabwe removed
union.BRICS removed
union.Common_Wealth removed
union.European_Union removed
union.North_American_Free_Trade removed
union.Southeast_Asian_Nations removed
Number of records removed 1036

CLOSE 0
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBLOCATE">
<span class="sig-name descname"><span class="pre">DBLOCATE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[[qualifier.]key/key-prefix]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBLOCATE" title="Link to this definition"></a></dt>
<dd><p>Positions to a key/value record.</p>
<p>Positions the VSAM to the first occurrence of the qualifier and key. If the
key parameter does not exist or is the prefix of a key, LOCATE positions it
to the key which comes next.</p>
<p>The records can be read sequentially by DBNEXT. The qualifier parameter
defaults to “any”.</p>
<p>Return code:
- 0 Get successfully
- 8 Get failed</p>
<p>Variables:
- <cite>dbKey</cite> contains the key
- <cite>dbFKey</cite> contains the full key (including the qualifier, key)
- <cite>dbRC</cite> return code of the function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBNEXT">
<span class="sig-name descname"><span class="pre">DBNEXT</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">ALL</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#DBNEXT" title="Link to this definition"></a></dt>
<dd><p>Reads the next key/value record.</p>
<p>Following a DBLOCATE, the first, or next, record will be read. It will be
returned as the next record if it matches the key given in DBLOCATE;
otherwise, ALL must be supplied as a parameter. Any records that come after
will be returned. The ending must be controlled by your REXX script. After
the last record, the EOF condition will be reported</p>
<p>The qualifier parameter defaults to “any”.</p>
<p>Return code:
- 0 Get successfully
- 8 Get failed</p>
<p>Variables:
- <cite>dbKey</cite> contains the key
- <cite>dbFKey</cite> contains the full key (including the qualifier, key)
- <cite>dbResult</cite> contains the full record (including the full key)
- <cite>dbRC</cite> return code of the function</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cm">/* Locate North America and read all continents following */</span>
<span class="linenos">2</span><span class="kr">say</span><span class="w"> </span>DBLOCATE<span class="o">(</span><span class="s">&#39;Cont.North America&#39;</span><span class="o">)</span>
<span class="linenos">3</span><span class="kr">do</span><span class="w"> </span><span class="kr">forever</span>
<span class="linenos">4</span><span class="w">   </span><span class="kr">if</span><span class="w"> </span>DBNEXT<span class="o">()&gt;</span><span class="m">0</span><span class="w"> </span><span class="kr">then</span><span class="w"> </span><span class="kr">leave</span>
<span class="linenos">5</span><span class="w">   </span><span class="kr">say</span><span class="w"> </span>DBRESULT
<span class="linenos">6</span><span class="kr">end</span>
</pre></div>
</div>
<p>Results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Continent</span> <span class="n">North</span> <span class="n">America</span>
<span class="n">Continent</span> <span class="n">South</span> <span class="n">America</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBLINK">
<span class="sig-name descname"><span class="pre">DBLINK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key,[qualifier.]key,</span> <span class="pre">link-type</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBLINK" title="Link to this definition"></a></dt>
<dd><p>Link two key/value records.</p>
<p>DBLINK produces a record in the Reference Dataset that contains both keys
and the link-type as the reference key. Both records must exist. This
allows the navigation between the source records.</p>
<p>The qualifier parameters default to “any”.</p>
<p>Return code :
- 0 Both records successfully linked
- 8 link failed, check the existence of source and target record</p>
<p>Variables:
- <cite>dbRC</cite> return code of the function
- <cite>dbLHS</cite> full-key of the source-record
- <cite>dbRHS</cite> full-key of the target-record</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBDELREF">
<span class="sig-name descname"><span class="pre">DBDELREF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key,[qualifier.]key,</span> <span class="pre">link-type</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBDELREF" title="Link to this definition"></a></dt>
<dd><p>de-link two key/value records</p>
<p>DBDELREF removes the link between two source records. It is the counterpart
to DBLINK. The qualifier parameters default to “any”.</p>
<p>Return code :
- 0 link successfully removed
- 8 link remove failed</p>
<p>Variables:
- <cite>dbRC</cite> return code of the function
- <cite>dbLHS</cite> full-key of the source-record
- <cite>dbRHS</cite> full-key of the target-record</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBDELREFALL">
<span class="sig-name descname"><span class="pre">DBDELREFALL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBDELREFALL" title="Link to this definition"></a></dt>
<dd><p>de-link all references of a source record</p>
<p>All links that were started from a source record are removed by
DBDELREFALL. Links initiated from another source record to this one, are
not removed. The default value for the qualifier is “any”.</p>
<p>Return code :
- 0 links successfully removed
- 8 links remove failed</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBPRINT">
<span class="sig-name descname"><span class="pre">DBPRINT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBPRINT" title="Link to this definition"></a></dt>
<dd><p>Prints VSAM KEY Value Record including created References. If an information
model is defined it also splits the record in its attributes.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>DBPRINT country.U.S.A

country.U.S.A
// ------------------------------------------
// Source available
//            Attributes
// ------------------------------------------
 *ACRONYM           USA
 *CAPITAL           Washington DC
 *DESCRIPTION       ?_
 *VISITED           ?_
// ------------------------------------------
//            Links to other Records
// ------------------------------------------
 &gt;CAPITAL-IS        city.WASHINGTON DC
 &gt;CONTAINED-IN      continent.NORTH AMERICA
 &gt;MEMBER-OF         union.NORTH AMERICAN FREE TRADE
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBOUTARRAY">
<span class="sig-name descname"><span class="pre">DBOUTARRAY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array-number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBOUTARRAY" title="Link to this definition"></a></dt>
<dd><p>stores all created output of a command in an array</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">s4</span><span class="o">=</span><span class="n">screate</span><span class="p">(</span><span class="mi">250</span><span class="p">)</span>                  <span class="o">/*</span> <span class="n">create</span> <span class="n">an</span> <span class="n">array</span> <span class="o">*/</span>
<span class="n">call</span> <span class="n">setg</span><span class="p">(</span><span class="s1">&#39;dbOutArray&#39;</span><span class="p">,</span><span class="n">s4</span><span class="p">)</span>       <span class="o">/*</span> <span class="n">assign</span> <span class="n">it</span> <span class="n">to</span> <span class="n">dboutarray</span> <span class="o">*/</span>
<span class="n">call</span> <span class="n">dbprint</span><span class="p">(</span><span class="n">country</span><span class="p">,</span><span class="s1">&#39;DETAILS&#39;</span><span class="p">)</span>  <span class="o">/*</span> <span class="n">run</span> <span class="n">command</span><span class="p">,</span> <span class="n">output</span> <span class="n">stored</span> <span class="ow">in</span> <span class="n">array</span> <span class="o">*/</span>
<span class="n">call</span> <span class="n">setg</span><span class="p">(</span><span class="s1">&#39;dbOutArray&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>       <span class="o">/*</span> <span class="n">reset</span> <span class="n">assignment</span><span class="p">,</span> <span class="nb">next</span> <span class="n">commands</span> <span class="n">will</span> <span class="n">be</span>
                                    <span class="n">normally</span> <span class="n">displayed</span> <span class="o">*/</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBSAY">
<span class="sig-name descname"><span class="pre">DBSAY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output-line</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBSAY" title="Link to this definition"></a></dt>
<dd><p>Prints the line (like SAY does), but DBOUTARRAY can also redirect it to an
array. This lets you mix your output with any Key/Value command.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBRCOUNT">
<span class="sig-name descname"><span class="pre">DBRCOUNT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key,'REFERENCES/USAGES'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBRCOUNT" title="Link to this definition"></a></dt>
<dd><p>Counts the references or usages of a specific Key/Value record.</p>
</dd></dl>

</section>
<section id="report-and-maintenance-functions">
<h2><span class="section-number">23.9. </span>Report and Maintenance Functions<a class="headerlink" href="#report-and-maintenance-functions" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="DBLIST">
<span class="sig-name descname"><span class="pre">DBLIST</span></span><span class="sig-paren">(</span><span class="optional">[</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">QUALIFIER/ONLY/ANY/CONTAINS</span></span></em><span class="optional">]</span>, <em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#DBLIST" title="Link to this definition"></a></dt>
<dd><p>List all records using the keyword (1. Parameter) and string combination.</p>
<p>If DBLIST is run without any parameters, it returns all entries for the
active room.</p>
<p>Keyword:
- <cite>QUALIFIER</cite> lists all records of the qualifier defined in the string parameter
- <cite>ONLY</cite> lists all records whose key starts with the string parameter. The key is the plain key without the qualifier
- <cite>ANY</cite> lists all records whose key contains the string parameter. The key is the plain key without the qualifier
- <cite>CONTAINS</cite> lists all records whose record content contains string parameter</p>
<p>The DBLIST Format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">List</span> <span class="n">records</span> <span class="n">of</span> <span class="n">room</span> <span class="n">WORLD</span><span class="p">(</span><span class="n">AB</span><span class="p">)</span> <span class="k">with</span> <span class="n">starting</span> <span class="n">key</span> <span class="n">Wa</span>
<span class="o">-----------------------------------------------------------------------</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Wad</span> <span class="n">Medani</span>                            <span class="n">Source</span> <span class="mi">265124</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Warsaw</span>                                <span class="n">Source</span> <span class="mi">1428379</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Washington</span>                            <span class="n">Source</span> <span class="mi">3693775</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Washington</span> <span class="n">DC</span>                         <span class="n">Dummy</span>  <span class="n">DUMMY</span>
<span class="n">List</span> <span class="n">contains</span> <span class="mi">5</span> <span class="n">records</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The first column contains the qualifier and the key</p></li>
<li><p>The second column contains either Source or Dummy.
- Source means a source record was inserted via DBSET (or equivalent command)
- Dummy means no source record was inserted yet, but the name has been reserved by a</p></li>
<li><p>DBREFERENCE command: The third column contains the source record</p></li>
</ul>
</dd></dl>

<p>Some examples:</p>
<blockquote>
<div><div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">CALL</span><span class="w"> </span>DBLIST<span class="o">()</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>List all records of room WORLD(AB)
-------------------------------------------------------------------
 any.AUS                                    Dummy  DUMMY
 any.Canberra                               Dummy  DUMMY
 any.Mainland of the Australian continent   Dummy  DUMMY
 any.USA                                    Dummy  DUMMY
 any.Washington DC                          Dummy  DUMMY
 any.YES                                    Dummy  DUMMY
 city.`Ajman                                Source 376263
 city.Aarhus                                Source 219041
 city.Aba                                   Source 1174779
 city.Abidjan                               Source 3823793
 city.Abomey-Calavi                         Source 503669
 city.Abu Dhabi                             Source 1138691
 city.Abuja                                 Source 2894719
 city.Accra                                 Source 1833578
 city.Ad Dammam                             Source 693590
 city.Adana                                 Source 1355973
 city.Addis Ababa                           Source 2334972
 city.Adelaide                              Source 994888
 city.Aden                                  Source 389562
 city.Aguadilla                             Source 199889
...
</pre></div>
</div>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">call</span><span class="w"> </span>dblist<span class="o">(</span><span class="s">&#39;QUALIFIER&#39;</span><span class="o">,</span><span class="s">&quot;Continent&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">List</span> <span class="nb">all</span> <span class="n">records</span> <span class="n">of</span> <span class="n">room</span> <span class="n">WORLD</span><span class="p">(</span><span class="n">AB</span><span class="p">)</span> <span class="k">with</span> <span class="n">Qualifier</span> <span class="n">continent</span>
<span class="o">--------------------------------------------------------------------</span>
 <span class="n">continent</span><span class="o">.</span><span class="n">Africa</span>                           <span class="n">Dummy</span>  <span class="n">DUMMY</span>
 <span class="n">continent</span><span class="o">.</span><span class="n">Asia</span>                             <span class="n">Dummy</span>  <span class="n">DUMMY</span>
 <span class="n">continent</span><span class="o">.</span><span class="n">Australia</span>                        <span class="n">Dummy</span>  <span class="n">DUMMY</span>
 <span class="n">continent</span><span class="o">.</span><span class="n">Europe</span>                           <span class="n">Dummy</span>  <span class="n">DUMMY</span>
 <span class="n">continent</span><span class="o">.</span><span class="n">North</span> <span class="n">America</span>                    <span class="n">Dummy</span>  <span class="n">DUMMY</span>
 <span class="n">continent</span><span class="o">.</span><span class="n">South</span> <span class="n">America</span>                    <span class="n">Dummy</span>  <span class="n">DUMMY</span>
<span class="n">List</span> <span class="n">contains</span> <span class="mi">6</span> <span class="n">records</span>
</pre></div>
</div>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">call</span><span class="w"> </span>dblist<span class="o">(</span><span class="s">&#39;ONLY&#39;</span><span class="o">,</span><span class="s">&quot;Wa&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">List</span> <span class="n">records</span> <span class="n">of</span> <span class="n">room</span> <span class="n">WORLD</span><span class="p">(</span><span class="n">AB</span><span class="p">)</span> <span class="k">with</span> <span class="n">starting</span> <span class="n">key</span> <span class="n">Wa</span>
<span class="o">-----------------------------------------------------------------------</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Wad</span> <span class="n">Medani</span>                            <span class="n">Source</span> <span class="mi">265124</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Warsaw</span>                                <span class="n">Source</span> <span class="mi">1428379</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Washington</span>                            <span class="n">Source</span> <span class="mi">3693775</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Washington</span> <span class="n">DC</span>                         <span class="n">Dummy</span>  <span class="n">DUMMY</span>
<span class="n">List</span> <span class="n">contains</span> <span class="mi">5</span> <span class="n">records</span>
</pre></div>
</div>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">call</span><span class="w"> </span>dblist<span class="o">(</span><span class="s">&#39;ANY&#39;</span><span class="o">,</span><span class="s">&quot;Mu&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">List</span> <span class="n">records</span> <span class="n">of</span> <span class="n">room</span> <span class="n">WORLD</span><span class="p">(</span><span class="n">AB</span><span class="p">)</span> <span class="n">containing</span> <span class="n">Mu</span> <span class="ow">in</span> <span class="n">key</span>
<span class="o">--------------------------------------------------------------------</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Multan</span>                                <span class="n">Source</span> <span class="mi">1437257</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Mumbai</span>                                <span class="n">Source</span> <span class="mi">19175018</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Munich</span>                                <span class="n">Source</span> <span class="mi">2000981</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Murcia</span>                                <span class="n">Source</span> <span class="mi">516575</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Muscat</span>                                <span class="n">Source</span> <span class="mi">1091400</span>
<span class="n">List</span> <span class="n">contains</span> <span class="mi">5</span> <span class="n">records</span>
</pre></div>
</div>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">call</span><span class="w"> </span>dblist<span class="o">(</span><span class="s">&#39;CONTAIN&#39;</span><span class="o">,</span><span class="s">&quot;265&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">List</span> <span class="n">records</span> <span class="n">of</span> <span class="n">room</span> <span class="n">WORLD</span><span class="p">(</span><span class="n">AB</span><span class="p">)</span> <span class="n">containing</span> <span class="mi">265</span>
<span class="o">------------------------------------------------------------------------</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Ahvaz</span>                                 <span class="n">Source</span> <span class="mi">968265</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Bamako</span>                                <span class="n">Source</span> <span class="mi">1542654</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Busan</span>                                 <span class="n">Source</span> <span class="mi">2651469</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Oskemen</span>                               <span class="n">Source</span> <span class="mi">265766</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Peshawar</span>                              <span class="n">Source</span> <span class="mi">1512657</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Tanch</span><span class="s1">&#39;on                              Source 265573</span>
 <span class="n">city</span><span class="o">.</span><span class="n">Wad</span> <span class="n">Medani</span>                            <span class="n">Source</span> <span class="mi">265124</span>
<span class="n">List</span> <span class="n">contains</span> <span class="mi">7</span> <span class="n">records</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="DBKEEP">
<span class="sig-name descname"><span class="pre">DBKEEP</span></span><span class="sig-paren">(</span><span class="optional">[</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">QUALIFIER/ONLY/ANY/CONTAINS</span></span></em><span class="optional">]</span>, <em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#DBKEEP" title="Link to this definition"></a></dt>
<dd><p>The functionality is similar to that of DBLIST, except that it saves the
result in a SARRAY that can be utilised in FMTLIST to be displayed or any
other post-process.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the created SARRAY number</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>s2<span class="o">=</span>dbkeep<span class="o">(</span><span class="s">&#39;Qualifier&#39;</span><span class="o">,</span><span class="s">&#39;Country&#39;</span><span class="o">)</span>
<span class="linenos">2</span>buffer<span class="o">.</span><span class="m">0</span><span class="o">=</span><span class="s">&#39;ARRAY &#39;</span>s1
<span class="linenos">3</span><span class="kr">Call</span><span class="w"> </span>fmtlist
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBNKEEP">
<span class="sig-name descname"><span class="pre">DBNKEEP</span></span><span class="sig-paren">(</span><span class="optional">[</span><span class="optional">[</span><em class="sig-param"><span class="n"><span class="pre">QUALIFIER/ONLY/ANY/CONTAINS</span></span></em><span class="optional">]</span>, <em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#DBNKEEP" title="Link to this definition"></a></dt>
<dd><p>The functionality is the same as that of DBKEEP, but all messages are suppressed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the created SARRAY number</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">DBKKEEP([[QUALIFIER/ONLY/ANY/CONTAINS],string])</span>&#160; <span class="pre">lists</span> <span class="pre">records</span></span></dt>
<dd><p>The functionality is similar to that of DBKEEP, except just the KEY is saved as the result in a SARRAY.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the created SARRAY number</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBHOOD">
<span class="sig-name descname"><span class="pre">DBHOOD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBHOOD" title="Link to this definition"></a></dt>
<dd><p>Prints the neighbourhood (References) of a Record.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DBHOOD</span> <span class="n">country</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
<span class="n">Result</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">ATLANTA</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">ATLANTA</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">BOSTON</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">BOSTON</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">CHICAGO</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">CHICAGO</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">DALLAS</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">DALLAS</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">HOUSTON</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">HOUSTON</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">LOS</span> <span class="n">ANGELES</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">LOS</span> <span class="n">ANGELES</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">MIAMI</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">MIAMI</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">NEW</span> <span class="n">YORK</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">NEW</span> <span class="n">YORK</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">PHILADELPHIA</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">PHILADELPHIA</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">WASHINGTON</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">city</span><span class="o">.</span><span class="n">WASHINGTON</span><span class="p">:</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
   <span class="o">|</span>  <span class="n">Refer</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">to</span> <span class="n">country</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>
   <span class="n">V</span>
<span class="o">+--------------------------------------------------+</span>
<span class="o">|</span> <span class="n">country</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">A</span>                                    <span class="o">|</span>
<span class="o">+--------------------------------------------------+</span>
   <span class="o">|</span>  <span class="n">Reference</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">country.U.S.A</span>
   <span class="n">V</span>
  <span class="n">CAPITAL</span><span class="o">-</span><span class="n">IS</span>        <span class="n">city</span><span class="o">.</span><span class="n">WASHINGTON</span> <span class="n">DC</span>
  <span class="n">CONTAINED</span><span class="o">-</span><span class="n">IN</span>      <span class="n">continent</span><span class="o">.</span><span class="n">NORTH</span> <span class="n">AMERICA</span>
  <span class="n">MEMBER</span><span class="o">-</span><span class="n">OF</span>         <span class="n">union</span><span class="o">.</span><span class="n">NORTH</span> <span class="n">AMERICAN</span> <span class="n">FREE</span> <span class="n">TRADE</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBREFERENCE">
<span class="sig-name descname"><span class="pre">DBREFERENCE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key,[max-level],[REFS/DETAILS]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBREFERENCE" title="Link to this definition"></a></dt>
<dd><p>Navigates from a given qualifier.key combination to all referred records
(forward direction). Max-level defines how many nested levels are allowed
(the default is 99). With REFS only the referred entries will be reported.
With  DETAILS referred entries and the link type are reported.</p>
<p>The qualifier parameter defaults to “any”.</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">Call</span><span class="w"> </span>dbreference<span class="o">(</span><span class="s">&#39;country.USA&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>Results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">References</span> <span class="n">of</span> <span class="n">Country</span><span class="o">.</span><span class="n">USA</span>
<span class="o">--------------------------------------------</span>
<span class="n">Country</span><span class="o">.</span><span class="n">USA</span> <span class="o">--</span> <span class="n">part</span> <span class="n">of</span> <span class="o">--&gt;</span>  <span class="n">North</span> <span class="n">America</span>

<span class="n">Which</span> <span class="n">references</span> <span class="n">constitute</span> <span class="n">city</span><span class="o">.</span><span class="n">Munich</span><span class="p">,</span> <span class="mi">99</span> <span class="n">levels</span> <span class="n">down</span><span class="p">,</span> <span class="n">report</span> <span class="n">referred</span> <span class="n">entries</span> <span class="n">only</span><span class="p">:</span>
<span class="n">Call</span> <span class="n">dbreference</span><span class="p">(</span><span class="s1">&#39;country.USA&#39;</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="s1">&#39;REFS&#39;</span><span class="p">)</span>

<span class="n">city</span><span class="o">.</span><span class="n">Munich</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">country</span><span class="o">.</span><span class="n">GERMANY</span>
  <span class="n">CAPITAL</span><span class="o">-</span><span class="n">IS</span>        <span class="n">city</span><span class="o">.</span><span class="n">BERLIN</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">country</span><span class="o">.</span><span class="n">GERMANY</span>
  <span class="n">CONTAINED</span><span class="o">-</span><span class="n">IN</span>      <span class="n">continent</span><span class="o">.</span><span class="n">EUROPE</span>
  <span class="n">MEMBER</span><span class="o">-</span><span class="n">OF</span>         <span class="n">union</span><span class="o">.</span><span class="n">EUROPEAN</span> <span class="n">UNION</span>
  <span class="n">SIGHT</span>             <span class="n">event</span><span class="o">.</span><span class="n">OCTOBERFEST</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">HACKERBRAEU</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">HOFBRAEU</span>
  <span class="n">TYPE</span>              <span class="nb">any</span><span class="o">.</span><span class="n">DARK</span>
  <span class="n">TYPE</span>              <span class="nb">any</span><span class="o">.</span><span class="n">EXPORT</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">LOEWENBRAEU</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">PAULANER</span>
  <span class="n">SIGHT</span>             <span class="n">location</span><span class="o">.</span><span class="n">HOFBRAEUHAUS</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">HOFBRAEU</span>
<span class="n">Elements</span> <span class="n">found</span> <span class="mi">14</span>
</pre></div>
</div>
<p>Which references constitute city.Munich, 99 levels down, report referred and link type entries only:</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">Call</span><span class="w"> </span>dbreference<span class="o">(</span><span class="s">&#39;country.USA&#39;</span><span class="o">,</span><span class="m">99</span><span class="o">,</span><span class="s">&#39;LINK&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>Results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">city</span><span class="o">.</span><span class="n">Munich</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">country</span><span class="o">.</span><span class="n">GERMANY</span>
  <span class="n">CAPITAL</span><span class="o">-</span><span class="n">IS</span>        <span class="n">city</span><span class="o">.</span><span class="n">BERLIN</span>
  <span class="n">PART</span><span class="o">-</span><span class="n">OF</span>           <span class="n">country</span><span class="o">.</span><span class="n">GERMANY</span>
  <span class="n">CONTAINED</span><span class="o">-</span><span class="n">IN</span>      <span class="n">continent</span><span class="o">.</span><span class="n">EUROPE</span>
  <span class="n">MEMBER</span><span class="o">-</span><span class="n">OF</span>         <span class="n">union</span><span class="o">.</span><span class="n">EUROPEAN</span> <span class="n">UNION</span>
  <span class="n">SIGHT</span>             <span class="n">event</span><span class="o">.</span><span class="n">OCTOBERFEST</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">HACKERBRAEU</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">HOFBRAEU</span>
  <span class="n">TYPE</span>              <span class="nb">any</span><span class="o">.</span><span class="n">DARK</span>
  <span class="n">TYPE</span>              <span class="nb">any</span><span class="o">.</span><span class="n">EXPORT</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">LOEWENBRAEU</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">PAULANER</span>
  <span class="n">SIGHT</span>             <span class="n">location</span><span class="o">.</span><span class="n">HOFBRAEUHAUS</span>
  <span class="n">BREWERY</span>           <span class="nb">any</span><span class="o">.</span><span class="n">HOFBRAEU</span>
<span class="n">Elements</span> <span class="n">found</span> <span class="mi">14</span>
</pre></div>
</div>
<p>Which references constitute city.Munich, 99 levels down (maximum):</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">Call</span><span class="w"> </span>dbreference<span class="o">(</span><span class="s">&#39;city.Munich&#39;</span><span class="o">,</span><span class="m">99</span><span class="o">)</span>
</pre></div>
</div>
<p>Results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">References</span> <span class="n">of</span> <span class="n">city</span><span class="o">.</span><span class="n">Munich</span>
<span class="o">------------------------------------------------------------------------</span>
 <span class="mi">1</span> <span class="n">city</span><span class="o">.</span><span class="n">Munich</span>
 <span class="mi">1</span> <span class="o">+-</span> <span class="n">part</span><span class="o">-</span><span class="n">of</span>        <span class="o">-&gt;</span>  <span class="n">country</span><span class="o">.</span><span class="n">GERMANY</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="n">country</span><span class="o">.</span><span class="n">GERMANY</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="o">+-</span> <span class="n">capital</span><span class="o">-</span><span class="ow">is</span>     <span class="o">-&gt;</span>  <span class="n">city</span><span class="o">.</span><span class="n">BERLIN</span>
 <span class="mi">3</span> <span class="o">|</span>  <span class="o">|</span>  <span class="n">city</span><span class="o">.</span><span class="n">BERLIN</span>
 <span class="mi">3</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">+-</span> <span class="n">part</span><span class="o">-</span><span class="n">of</span>        <span class="o">-&gt;</span>  <span class="n">country</span><span class="o">.</span><span class="n">GERMANY</span>
 <span class="mi">4</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>  <span class="o">|-</span> <span class="n">capital</span><span class="o">-</span><span class="ow">is</span>     <span class="o">-&gt;</span><span class="c1"># city.BERLIN</span>
 <span class="mi">4</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>  <span class="o">|-</span> <span class="n">contained</span><span class="o">-</span><span class="ow">in</span>   <span class="o">-&gt;</span>  <span class="n">continent</span><span class="o">.</span><span class="n">EUROPE</span>
 <span class="mi">4</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>  <span class="n">country</span><span class="o">.</span><span class="n">GERMANY</span>
 <span class="mi">4</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">|</span>  <span class="o">+-</span> <span class="n">member</span><span class="o">-</span><span class="n">of</span>      <span class="o">-&gt;</span>  <span class="n">union</span><span class="o">.</span><span class="n">EUROPEAN</span> <span class="n">UNION</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="o">|-</span> <span class="n">contained</span><span class="o">-</span><span class="ow">in</span>   <span class="o">-&gt;</span><span class="c1"># continent.EUROPE</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="o">|-</span> <span class="n">member</span><span class="o">-</span><span class="n">of</span>      <span class="o">-&gt;</span><span class="c1"># union.EUROPEAN UNION</span>
 <span class="mi">1</span> <span class="o">|-</span> <span class="n">sight</span>          <span class="o">-&gt;</span>  <span class="n">event</span><span class="o">.</span><span class="n">OCTOBERFEST</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="n">event</span><span class="o">.</span><span class="n">OCTOBERFEST</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="o">+-</span> <span class="n">brewery</span>        <span class="o">-&gt;</span>  <span class="nb">any</span><span class="o">.</span><span class="n">HACKERBRAEU</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="n">event</span><span class="o">.</span><span class="n">OCTOBERFEST</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="o">+-</span> <span class="n">brewery</span>        <span class="o">-&gt;</span>  <span class="nb">any</span><span class="o">.</span><span class="n">HOFBRAEU</span>
 <span class="mi">3</span> <span class="o">|</span>  <span class="o">|</span>  <span class="nb">any</span><span class="o">.</span><span class="n">HOFBRAEU</span>
<span class="mi">2</span> <span class="o">|</span>  <span class="o">+-</span> <span class="n">brewery</span>        <span class="o">-&gt;</span>  <span class="nb">any</span><span class="o">.</span><span class="n">LOEWENBRAEU</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="n">event</span><span class="o">.</span><span class="n">OCTOBERFEST</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="o">+-</span> <span class="n">brewery</span>        <span class="o">-&gt;</span>  <span class="nb">any</span><span class="o">.</span><span class="n">PAULANER</span>
 <span class="mi">1</span> <span class="n">city</span><span class="o">.</span><span class="n">Munich</span>
 <span class="mi">1</span> <span class="o">+-</span> <span class="n">sight</span>          <span class="o">-&gt;</span>  <span class="n">location</span><span class="o">.</span><span class="n">HOFBRAEUHAUS</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="n">location</span><span class="o">.</span><span class="n">HOFBRAEUHAUS</span>
 <span class="mi">2</span> <span class="o">|</span>  <span class="o">+-</span> <span class="n">brewery</span>        <span class="o">-&gt;</span>  <span class="nb">any</span><span class="o">.</span><span class="n">HOFBRAEU</span>
 <span class="mi">3</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">|-</span> <span class="nb">type</span>           <span class="o">-&gt;</span><span class="c1"># any.DARK</span>
 <span class="mi">3</span> <span class="o">|</span>  <span class="o">|</span>  <span class="o">|-</span> <span class="nb">type</span>           <span class="o">-&gt;</span><span class="c1"># any.EXPORT</span>
    <span class="o">-&gt;</span><span class="c1"># references have been reported previously</span>
<span class="n">Elements</span> <span class="n">found</span> <span class="mi">14</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBUSAGE">
<span class="sig-name descname"><span class="pre">DBUSAGE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">[qualifier.]key,[REFS/DETAILS</span></em><span class="sig-paren">)</span><a class="headerlink" href="#DBUSAGE" title="Link to this definition"></a></dt>
<dd><p>Navigates from a given qualifier.key combination to all used records (backward
direction). Max-level defines how many nested levels are allowed (the
default is 99). With REFS only the used entries will be reported. With
DETAILS referred entries and the link type are reported.</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kr">Call</span><span class="w"> </span>dbusage<span class="o">(</span><span class="s">&#39;country.USA&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usages</span> <span class="n">of</span> <span class="n">Country</span><span class="o">.</span><span class="n">USA</span>
<span class="o">----------------------------------------------------</span>
<span class="n">Country</span><span class="o">.</span><span class="n">USA</span> <span class="o">--</span> <span class="n">Economy</span> <span class="o">&lt;--</span>  <span class="n">NAFTA</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DBROOMS">
<span class="sig-name descname"><span class="pre">DBROOMS</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DBROOMS" title="Link to this definition"></a></dt>
<dd><p>DBROOM displays all previously defined rooms.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">List</span> <span class="nb">all</span> <span class="n">defined</span> <span class="n">rooms</span>
  <span class="n">HILBERT</span><span class="s1">&#39;S LOBBY        SAA 0</span>
  <span class="n">MOSHE</span><span class="s1">&#39;S FOOD TRUCK     SAF 0</span>
  <span class="n">PETER</span><span class="s1">&#39;S BEACH BAR      SAD 0</span>
  <span class="n">WORLD</span>                  <span class="n">SAB</span> <span class="mi">0</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="key-value-database-tailoring">
<h2><span class="section-number">23.10. </span>Key/Value Database Tailoring<a class="headerlink" href="#key-value-database-tailoring" title="Link to this heading"></a></h2>
<section id="defining-an-information-model-optional">
<h3><span class="section-number">23.10.1. </span>Defining an Information Model (optional)<a class="headerlink" href="#defining-an-information-model-optional" title="Link to this heading"></a></h3>
<p>You may specify a record structure using an information model, which allows the
record to be divided into distinct attributes. Every qualification has to have
its model defined if one has been set up. The information model is active in
the current room. Here is an illustration of the structure of the world database
sample:</p>
<p>Sample information model in the world database:</p>
<p>The qualifier country has the following attributes:</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="kr">call</span><span class="w"> </span>dbkvimadd<span class="w"> </span><span class="s">&#39;country: Acronym Capital Description Visited&#39;</span>
</pre></div>
</div>
<p>The qualifier city has the following attributes:</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="kr">call</span><span class="w"> </span>dbkvimadd<span class="w"> </span><span class="s">&#39;city: population Description&#39;</span>
</pre></div>
</div>
<p>if all qualifiers (regard them as types) the information model must be built,
which can be done by:</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="kr">call</span><span class="w"> </span>dbkvimbuild
</pre></div>
</div>
<p>The information model should be defined at the initialisation process before the
database is loaded. The following is the definition of the world database:</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cm">/* ------------------------------------------------------------</span>
<span class="linenos"> 2</span><span class="cm"> * Store a simple Key/Value Information Model</span>
<span class="linenos"> 3</span><span class="cm"> * Example:</span>
<span class="linenos"> 4</span><span class="cm"> *    country: Acronym Capital Description Visited</span>
<span class="linenos"> 5</span><span class="cm"> *      |      |       |       |           fourth-attribute</span>
<span class="linenos"> 6</span><span class="cm"> *      |      |       |       third-attribute</span>
<span class="linenos"> 7</span><span class="cm"> *      |      |       second-attribute</span>
<span class="linenos"> 8</span><span class="cm"> *      |      first-attribute</span>
<span class="linenos"> 9</span><span class="cm"> *      record-type</span>
<span class="linenos">10</span><span class="cm"> * ------------------------------------------------------------</span>
<span class="linenos">11</span><span class="cm"> */</span>
<span class="linenos">12</span><span class="kr">call</span><span class="w"> </span>dbkvimadd<span class="w"> </span><span class="s">&#39;country: Acronym Capital Description Visited&#39;</span>
<span class="linenos">13</span><span class="kr">call</span><span class="w"> </span>dbkvimadd<span class="w"> </span><span class="s">&#39;city: population Description&#39;</span>
<span class="linenos">14</span><span class="cm">/* ------------------------------------------------------------</span>
<span class="linenos">15</span><span class="cm"> * Build Information Model and save it in the Control Record</span>
<span class="linenos">16</span><span class="cm"> * ------------------------------------------------------------</span>
<span class="linenos">17</span><span class="cm"> */</span>
<span class="linenos">18</span><span class="kr">call</span><span class="w"> </span>dbkvimbuild
</pre></div>
</div>
<p>Once activated the record can be automatically structured by some commands into
its single attributes for example DBPRINT.</p>
</section>
<section id="defining-additional-key-value-databases">
<h3><span class="section-number">23.10.2. </span>Defining additional Key/Value Databases<a class="headerlink" href="#defining-additional-key-value-databases" title="Link to this heading"></a></h3>
<p>You can add additional Key/Value Databases as needed. Their definition lengths
may vary (e.g. qualifier and key)</p>
</section>
<section id="setting-up-a-key-value-profile">
<h3><span class="section-number">23.10.3. </span>Setting up a Key/Value Profile<a class="headerlink" href="#setting-up-a-key-value-profile" title="Link to this heading"></a></h3>
<p>To personalise the profile REXX script, alter the following REXX variables; any
valid dataset or dd name may be selected: define a profile, for example, <cite>DBPROF1</cite></p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cm">/* ------------------------------------------------------------</span>
<span class="linenos"> 2</span><span class="cm"> * Private Key/Value Profile</span>
<span class="linenos"> 3</span><span class="cm"> * ------------------------------------------------------------</span>
<span class="linenos"> 4</span><span class="cm"> */</span>
<span class="linenos"> 5</span><span class="w">  </span>ddprof<span class="o">.</span>DDKEY<span class="o">=</span><span class="s">&#39;PRIVALUE&#39;</span><span class="w">         </span><span class="cm">/* DD Name of Key/Value DB*/</span>
<span class="linenos"> 6</span><span class="w">  </span>ddprof<span class="o">.</span>DDREF<span class="o">=</span><span class="s">&#39;PRIREFS&#39;</span><span class="w">          </span><span class="cm">/* DD Name of Key/Ref DB  */</span>
<span class="linenos"> 7</span><span class="w">  </span>ddprof<span class="o">.</span>DSNKEY<span class="o">=</span><span class="s">&#39;BREXX.PRIVALUE&#39;</span><span class="w">  </span><span class="cm">/* DSN of Key/Value DB    */</span>
<span class="linenos"> 8</span><span class="w">  </span>ddprof<span class="o">.</span>DSNREF<span class="o">=</span><span class="s">&#39;BREXX.PROREFS&#39;</span><span class="w">   </span><span class="cm">/* DSN of Key/REF DB      */</span>
<span class="linenos"> 9</span><span class="w">  </span>ddprof<span class="o">.</span>keylen<span class="w"> </span><span class="o">=</span><span class="m">12</span><span class="w">                </span><span class="cm">/* Plain Key length              */</span>
<span class="linenos">10</span><span class="w">  </span>ddprof<span class="o">.</span>roomlen<span class="o">=</span><span class="m">2</span><span class="w">                 </span><span class="cm">/* Room length                   */</span>
<span class="linenos">11</span><span class="w">  </span>ddprof<span class="o">.</span>quallen<span class="o">=</span><span class="m">4</span><span class="w">                 </span><span class="cm">/* Qualifier/Project/Bucket      */</span>
<span class="linenos">12</span><span class="w">  </span>ddprof<span class="o">.</span>typelen<span class="o">=</span><span class="m">4</span><span class="w">                 </span><span class="cm">/* Type length in Reference DB   */</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="w">  </span>ddprof<span class="o">.</span>keyupper<span class="o">=</span><span class="m">1</span><span class="w">                </span><span class="cm">/* upper case translation of the */</span>
<span class="linenos">15</span><span class="w">                                   </span><span class="cm">/* key. 0: no, 1: yes            */</span>
<span class="linenos">16</span><span class="w">  </span>ddprof<span class="o">.</span>EnableDummy<span class="o">=</span><span class="m">1</span><span class="w">             </span><span class="cm">/* allow links between records   */</span>
<span class="linenos">17</span><span class="w">                                   </span><span class="cm">/* which do not exist, they will */</span>
<span class="linenos">18</span><span class="w">                                   </span><span class="cm">/* create DUMMY source records   */</span>
<span class="linenos">19</span><span class="w">                                   </span><span class="cm">/* 0: no, 1: yes                 */</span>
<span class="linenos">20</span><span class="w"> </span><span class="kr">return</span><span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Keylen</strong>: Key/Value key <cite>length=ddprof.keylen+ddprof.projlen+ddprof.roomlen</cite>. In our example <cite>Keylen=18</cite>.</p></li>
<li><p><strong>Reflen</strong>: Reference key <cite>length=2*keylen+1+ddprof.typelen</cite>. In our example <cite>Reflen=41</cite>.</p></li>
</ul>
</section>
<section id="cluster-definition">
<h3><span class="section-number">23.10.4. </span>Cluster Definition<a class="headerlink" href="#cluster-definition" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Create a copy of the member $CREKEYV of the BREXX installation dataset. Change the cluster definition accordingly.</p></li>
<li><p>Change the Cluster sizes so that it fits your need.</p></li>
<li><p>Submit the JCL</p></li>
</ol>
<p>For our Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">//*</span> <span class="o">----------------------------------------------------------------</span>
<span class="linenos"> 2</span><span class="o">//*</span> <span class="n">CREATE</span> <span class="n">A</span> <span class="n">NULL</span> <span class="n">RECORD</span> <span class="n">FOR</span> <span class="n">THE</span> <span class="n">KEY</span><span class="o">/</span><span class="n">VALUE</span> <span class="n">VSAM</span> <span class="n">FILES</span>
<span class="linenos"> 3</span><span class="o">//*</span> <span class="o">----------------------------------------------------------------</span>
<span class="linenos"> 4</span><span class="o">//</span><span class="n">EXEC</span>     <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">BREXX</span><span class="p">,</span><span class="n">PARM</span><span class="o">=</span><span class="s1">&#39;RXRUN&#39;</span><span class="p">,</span><span class="n">REGION</span><span class="o">=</span><span class="mi">6000</span><span class="n">K</span>
<span class="linenos"> 5</span><span class="o">//</span><span class="n">STEPLIB</span>  <span class="n">DD</span>   <span class="n">DSN</span><span class="o">=</span><span class="n">SYS2</span><span class="o">.</span><span class="n">LINKLIB</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="linenos"> 6</span><span class="o">//</span><span class="n">STDIN</span>    <span class="n">DD</span>   <span class="n">DUMMY</span>
<span class="linenos"> 7</span><span class="o">//</span><span class="n">STDOUT</span>   <span class="n">DD</span>   <span class="n">SYSOUT</span><span class="o">=*</span><span class="p">,</span><span class="n">DCB</span><span class="o">=</span><span class="p">(</span><span class="n">RECFM</span><span class="o">=</span><span class="n">FB</span><span class="p">,</span><span class="n">LRECL</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span><span class="n">BLKSIZE</span><span class="o">=</span><span class="mi">5600</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="o">//</span><span class="n">STDERR</span>   <span class="n">DD</span>   <span class="n">SYSOUT</span><span class="o">=*</span><span class="p">,</span><span class="n">DCB</span><span class="o">=</span><span class="p">(</span><span class="n">RECFM</span><span class="o">=</span><span class="n">FB</span><span class="p">,</span><span class="n">LRECL</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span><span class="n">BLKSIZE</span><span class="o">=</span><span class="mi">5600</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="o">//</span><span class="n">NULLREC</span>  <span class="n">DD</span> <span class="n">DSN</span><span class="o">=&amp;&amp;</span><span class="n">NULLREC</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="p">(,</span><span class="n">PASS</span><span class="p">),</span><span class="n">UNIT</span><span class="o">=</span><span class="n">VIO</span><span class="p">,</span><span class="n">SPACE</span><span class="o">=</span><span class="p">(</span><span class="n">TRK</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span>
<span class="linenos">10</span><span class="o">//</span>         <span class="n">DCB</span><span class="o">=</span><span class="p">(</span><span class="n">RECFM</span><span class="o">=</span><span class="n">FB</span><span class="p">,</span><span class="n">LRECL</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span><span class="n">BLKSIZE</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
<span class="linenos">11</span><span class="o">//</span><span class="n">RXRUN</span>    <span class="n">DD</span>   <span class="o">*</span>
<span class="linenos">12</span>   <span class="n">NULLR</span><span class="mf">.1</span><span class="o">=</span><span class="n">COPIES</span><span class="p">(</span><span class="s1">&#39;9&#39;</span><span class="p">,</span><span class="mi">255</span><span class="p">);</span> <span class="n">NULLR</span><span class="mf">.0</span><span class="o">=</span><span class="mi">1</span>
<span class="linenos">13</span>  <span class="s2">&quot;EXECIO * DISKW NULLREC (STEM NULLR. FINIS&quot;</span>
<span class="linenos">14</span><span class="o">/*</span>
<span class="linenos">15</span><span class="o">//*</span> <span class="o">----------------------------------------------------------------</span>
<span class="linenos">16</span><span class="o">//*</span> <span class="n">DELETE</span><span class="o">/</span><span class="n">DEFINE</span> <span class="n">THE</span> <span class="n">PROMOTE</span> <span class="n">VSAM</span> <span class="n">CHANGE</span> <span class="p">(</span><span class="n">CCID</span><span class="p">)</span> <span class="n">LIST</span> <span class="n">AND</span> <span class="n">PRIME</span> <span class="n">IT</span>
<span class="linenos">17</span><span class="o">//*</span> <span class="n">WITH</span> <span class="n">THE</span> <span class="n">CONTROL</span> <span class="n">RECORD</span>
<span class="linenos">18</span><span class="o">//*</span> <span class="o">----------------------------------------------------------------</span>
<span class="linenos">19</span><span class="o">//</span><span class="n">KEYVALUE</span> <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IDCAMS</span>
<span class="linenos">20</span><span class="o">//</span><span class="n">NULLREC</span>  <span class="n">DD</span> <span class="n">DSN</span><span class="o">=&amp;&amp;</span><span class="n">NULLREC</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="linenos">21</span><span class="o">//</span><span class="n">SYSPRINT</span> <span class="n">DD</span>   <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="linenos">22</span><span class="o">//</span><span class="n">SYSIN</span>    <span class="n">DD</span>   <span class="o">*</span>
<span class="linenos">23</span>  <span class="n">DELETE</span> <span class="n">BREXX</span><span class="o">.</span><span class="n">PRIVALUE</span> <span class="n">CLUSTER</span>
<span class="linenos">24</span>  <span class="n">SET</span> <span class="n">MAXCC</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">25</span>  <span class="n">DEFINE</span> <span class="n">CLUSTER</span>                           <span class="o">-</span>
<span class="linenos">26</span>           <span class="p">(</span><span class="n">NAME</span><span class="p">(</span><span class="n">BREXX</span><span class="o">.</span><span class="n">PRIVALUE</span><span class="p">)</span>           <span class="o">-</span>
<span class="linenos">27</span>            <span class="n">INDEXED</span>                        <span class="o">-</span>
<span class="linenos">28</span>            <span class="n">KEYS</span><span class="p">(</span><span class="mi">18</span> <span class="mi">0</span><span class="p">)</span>                     <span class="o">-</span>
<span class="linenos">29</span>            <span class="n">RECORDSIZE</span><span class="p">(</span><span class="mi">64</span> <span class="mi">8192</span><span class="p">)</span>            <span class="o">-</span>
<span class="linenos">30</span>            <span class="n">SHAREOPTIONS</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>              <span class="o">-</span>
<span class="linenos">31</span>            <span class="n">CYLINDERS</span><span class="p">(</span><span class="mi">600</span> <span class="mi">50</span><span class="p">)</span>              <span class="o">-</span>
<span class="linenos">32</span>            <span class="n">VOLUMES</span><span class="p">(</span><span class="n">PEJ001</span><span class="p">)</span>                <span class="o">-</span>
<span class="linenos">33</span>            <span class="n">UNIQUE</span>                         <span class="o">-</span>
<span class="linenos">34</span>            <span class="n">SPEED</span><span class="p">)</span>                         <span class="o">-</span>
<span class="linenos">35</span>         <span class="n">DATA</span>                              <span class="o">-</span>
<span class="linenos">36</span>            <span class="p">(</span><span class="n">NAME</span><span class="p">(</span><span class="n">BREXX</span><span class="o">.</span><span class="n">PRIVALUE</span><span class="o">.</span><span class="n">DATA</span><span class="p">))</span>    <span class="o">-</span>
<span class="linenos">37</span>         <span class="n">INDEX</span>                             <span class="o">-</span>
<span class="linenos">38</span>            <span class="p">(</span><span class="n">NAME</span><span class="p">(</span><span class="n">BREXX</span><span class="o">.</span><span class="n">PRIVALUE</span><span class="o">.</span><span class="n">INDEX</span><span class="p">))</span>
<span class="linenos">39</span>  <span class="n">IF</span> <span class="n">LASTCC</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="o">-</span>
<span class="linenos">40</span>     <span class="n">REPRO</span> <span class="n">INFILE</span><span class="p">(</span><span class="n">NULLREC</span><span class="p">)</span> <span class="n">ODS</span><span class="p">(</span><span class="n">BREXX</span><span class="o">.</span><span class="n">PRIVALUE</span><span class="p">)</span>
<span class="linenos">41</span><span class="o">/*</span>                                               <span class="o">/*</span>
<span class="linenos">42</span><span class="o">//</span><span class="n">KEYREF</span>   <span class="n">EXEC</span> <span class="n">PGM</span><span class="o">=</span><span class="n">IDCAMS</span>
<span class="linenos">43</span><span class="o">//</span><span class="n">NULLREC</span>  <span class="n">DD</span> <span class="n">DSN</span><span class="o">=&amp;&amp;</span><span class="n">NULLREC</span><span class="p">,</span><span class="n">DISP</span><span class="o">=</span><span class="n">SHR</span>
<span class="linenos">44</span><span class="o">//</span><span class="n">SYSPRINT</span> <span class="n">DD</span>   <span class="n">SYSOUT</span><span class="o">=*</span>
<span class="linenos">45</span><span class="o">//</span><span class="n">SYSIN</span>    <span class="n">DD</span>   <span class="o">*</span>
<span class="linenos">46</span>  <span class="n">DELETE</span> <span class="n">BREXX</span><span class="o">.</span><span class="n">PRIREFS</span> <span class="n">CLUSTER</span>
<span class="linenos">47</span>  <span class="n">SET</span> <span class="n">MAXCC</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">48</span>  <span class="n">DEFINE</span> <span class="n">CLUSTER</span>                           <span class="o">-</span>
<span class="linenos">49</span>           <span class="p">(</span><span class="n">NAME</span><span class="p">(</span><span class="n">BREXX</span><span class="o">.</span><span class="n">PRIREFS</span><span class="p">)</span>            <span class="o">-</span>
<span class="linenos">50</span>            <span class="n">INDEXED</span>                        <span class="o">-</span>
<span class="linenos">51</span>            <span class="n">KEYS</span><span class="p">(</span><span class="mi">41</span> <span class="mi">0</span><span class="p">)</span>                     <span class="o">-</span>
<span class="linenos">52</span>            <span class="n">RECORDSIZE</span><span class="p">(</span><span class="mi">64</span> <span class="mi">256</span><span class="p">)</span>             <span class="o">-</span>
<span class="linenos">53</span>            <span class="n">SHAREOPTIONS</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>              <span class="o">-</span>
<span class="linenos">54</span>            <span class="n">CYLINDERS</span><span class="p">(</span><span class="mi">50</span> <span class="mi">25</span><span class="p">)</span>               <span class="o">-</span>
<span class="linenos">55</span>            <span class="n">VOLUMES</span><span class="p">(</span><span class="n">PEJ001</span><span class="p">)</span>                <span class="o">-</span>
<span class="linenos">56</span>            <span class="n">UNIQUE</span>                         <span class="o">-</span>
<span class="linenos">57</span>            <span class="n">SPEED</span><span class="p">)</span>                         <span class="o">-</span>
<span class="linenos">58</span>         <span class="n">DATA</span>                              <span class="o">-</span>
<span class="linenos">59</span>            <span class="p">(</span><span class="n">NAME</span><span class="p">(</span><span class="n">BREXX</span><span class="o">.</span><span class="n">PRIREFS</span><span class="o">.</span><span class="n">DATA</span><span class="p">))</span>     <span class="o">-</span>
<span class="linenos">60</span>         <span class="n">INDEX</span>                             <span class="o">-</span>
<span class="linenos">61</span>            <span class="p">(</span><span class="n">NAME</span><span class="p">(</span><span class="n">BREXX</span><span class="o">.</span><span class="n">PRIREFS</span><span class="o">.</span><span class="n">INDEX</span><span class="p">))</span>
<span class="linenos">62</span>  <span class="n">IF</span> <span class="n">LASTCC</span> <span class="o">=</span> <span class="mi">0</span> <span class="n">THEN</span> <span class="o">-</span>
<span class="linenos">63</span>     <span class="n">REPRO</span> <span class="n">INFILE</span><span class="p">(</span><span class="n">NULLREC</span><span class="p">)</span> <span class="n">ODS</span><span class="p">(</span><span class="n">BREXX</span><span class="o">.</span><span class="n">PRIREFS</span><span class="p">)</span>
<span class="linenos">64</span><span class="o">/*</span>
<span class="linenos">65</span><span class="o">//</span>
</pre></div>
</div>
</section>
<section id="usage-of-the-new-cluster-definition">
<h3><span class="section-number">23.10.5. </span>Usage of the new Cluster Definition<a class="headerlink" href="#usage-of-the-new-cluster-definition" title="Link to this heading"></a></h3>
<p>Once the definition is constructed, you may use it by specifying the profile
name in the DBOPEN call, for example, DBPROF1:</p>
<div class="highlight-rexx notranslate"><div class="highlight"><pre><span></span><span class="kr">CALL</span><span class="w"> </span>DBOPEN<span class="o">(</span><span class="s">&#39;DBPROF1&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>There can only be one database open at the same time! If another database was
opened during the same run, it must be closed using a <cite>DBCLOSE</cite>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vsam.html" class="btn btn-neutral float-left" title="22. VSAM User’s Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fss.html" class="btn btn-neutral float-right" title="24. Formatted screens" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Peter Jacob (pej), Mike Großmann (mig).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>